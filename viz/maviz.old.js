var testJSON = {"id":"0","size":18538,"states":[{"id":1,"meanCentroidDist":1.032949,"size":7823,"centroid":[{"name":"hook_load","value":81.843157},{"name":"oil_temp_gearbox","value":30.851674},{"name":"oil_temp_swivel","value":35.195822},{"name":"pressure_gearbox","value":2.601852},{"name":"rpm","value":89.454408},{"name":"temp_ambient","value":15.583701},{"name":"torque","value":10.025706},{"name":"wob","value":2.028002}]},{"id":2,"meanCentroidDist":0.672473,"size":2549,"centroid":[{"name":"hook_load","value":82.979021},{"name":"oil_temp_gearbox","value":30.20977},{"name":"oil_temp_swivel","value":34.943083},{"name":"pressure_gearbox","value":2.638868},{"name":"rpm","value":92.6906},{"name":"temp_ambient","value":16.354149},{"name":"torque","value":8.831632},{"name":"wob","value":2.257291}]},{"id":3,"meanCentroidDist":1.137147,"size":775,"centroid":[{"name":"hook_load","value":4.797534},{"name":"oil_temp_gearbox","value":29.373635},{"name":"oil_temp_swivel","value":35.301245},{"name":"pressure_gearbox","value":1.16078},{"name":"rpm","value":4.268437},{"name":"temp_ambient","value":15.980895},{"name":"torque","value":0.456923},{"name":"wob","value":80.315216}]},{"id":4,"meanCentroidDist":1.692772,"size":35,"centroid":[{"name":"hook_load","value":2.025438},{"name":"oil_temp_gearbox","value":28.624944},{"name":"oil_temp_swivel","value":34.666389},{"name":"pressure_gearbox","value":3.038659},{"name":"rpm","value":0.932037},{"name":"temp_ambient","value":16.383033},{"name":"torque","value":26.904833},{"name":"wob","value":82.938262}]},{"id":5,"meanCentroidDist":0.807399,"size":1378,"centroid":[{"name":"hook_load","value":89.604316},{"name":"oil_temp_gearbox","value":31.843912},{"name":"oil_temp_swivel","value":36.563284},{"name":"pressure_gearbox","value":1.511599},{"name":"rpm","value":1.088154},{"name":"temp_ambient","value":15.766685},{"name":"torque","value":0.383467},{"name":"wob","value":-4.382614}]},{"id":6,"meanCentroidDist":0.278559,"size":923,"centroid":[{"name":"hook_load","value":86.974761},{"name":"oil_temp_gearbox","value":28.668017},{"name":"oil_temp_swivel","value":35.711119},{"name":"pressure_gearbox","value":1.514895},{"name":"rpm","value":1.23932},{"name":"temp_ambient","value":16.274855},{"name":"torque","value":0.441581},{"name":"wob","value":-2.011063}]},{"id":7,"meanCentroidDist":1.641419,"size":37,"centroid":[{"name":"hook_load","value":4.501043},{"name":"oil_temp_gearbox","value":30.608388},{"name":"oil_temp_swivel","value":35.245741},{"name":"pressure_gearbox","value":3.092077},{"name":"rpm","value":1.069521},{"name":"temp_ambient","value":15.68},{"name":"torque","value":25.290049},{"name":"wob","value":80.73834}]},{"id":8,"meanCentroidDist":0.625377,"size":5018,"centroid":[{"name":"hook_load","value":83.889907},{"name":"oil_temp_gearbox","value":32.080872},{"name":"oil_temp_swivel","value":36.319047},{"name":"pressure_gearbox","value":2.602538},{"name":"rpm","value":119.390459},{"name":"temp_ambient","value":15.83888},{"name":"torque","value":9.697034},{"name":"wob","value":1.349481}]}],"intensities":[[-7.510571,0,0,0,5.797101,0,0,1.71347],[0,-1.412319,0,0,0,0,0,1.412319],[0,0,-261.349364,10.97561,112.5,128.571429,9.302326,0],[0,0,102.857143,-102.857143,0,0,0,0],[17.647059,0,5.034965,0,-93.270259,70.588235,0,0],[0,33.962264,4.406365,0,0,-38.368629,0,0],[0,0,97.297297,0,0,0,-97.297297,0],[2.120766,0,0,0,2.218115,0,0,-4.33888]],"children":[{"id":"1","size":7823,"states":[{"id":9,"meanCentroidDist":0.477962,"size":3822,"centroid":[{"name":"hook_load","value":87.20831},{"name":"oil_temp_gearbox","value":30.689306},{"name":"oil_temp_swivel","value":35.135338},{"name":"pressure_gearbox","value":2.611916},{"name":"rpm","value":92.096391},{"name":"temp_ambient","value":15.601199},{"name":"torque","value":8.210203},{"name":"wob","value":-3.19534}]},{"id":10,"meanCentroidDist":0.125456,"size":2225,"centroid":[{"name":"hook_load","value":79.254718},{"name":"oil_temp_gearbox","value":30.947748},{"name":"oil_temp_swivel","value":35.227853},{"name":"pressure_gearbox","value":2.601031},{"name":"rpm","value":90.270802},{"name":"temp_ambient","value":15.572804},{"name":"torque","value":11.011452},{"name":"wob","value":4.511227}]},{"id":11,"meanCentroidDist":1.367192,"size":1776,"centroid":[{"name":"hook_load","value":85.389058},{"name":"oil_temp_gearbox","value":30.134283},{"name":"oil_temp_swivel","value":35.059705},{"name":"pressure_gearbox","value":2.468538},{"name":"rpm","value":18.920914},{"name":"temp_ambient","value":15.679987},{"name":"torque","value":5.035692},{"name":"wob","value":-0.14967}]}],"intensities":[[-109.199145,108.03485,1.164295],[50.157303,-50.157303,0],[3.256445,0,-3.256445]],"children":[{"id":"11","size":1776,"states":[{"id":41,"meanCentroidDist":0.045558,"size":39,"centroid":[{"name":"hook_load","value":84.291387},{"name":"oil_temp_gearbox","value":30.067302},{"name":"oil_temp_swivel","value":35.053483},{"name":"pressure_gearbox","value":2.507496},{"name":"rpm","value":19.545901},{"name":"temp_ambient","value":15.679979},{"name":"torque","value":5.214977},{"name":"wob","value":0.948004}]},{"id":42,"meanCentroidDist":0.022864,"size":24,"centroid":[{"name":"hook_load","value":87.169177},{"name":"oil_temp_gearbox","value":30.242887},{"name":"oil_temp_swivel","value":35.069787},{"name":"pressure_gearbox","value":2.405406},{"name":"rpm","value":17.907312},{"name":"temp_ambient","value":15.68},{"name":"torque","value":4.745182},{"name":"wob","value":-1.929793}]},{"id":43,"meanCentroidDist":0.613356,"size":1709,"centroid":[{"name":"hook_load","value":94.218579},{"name":"oil_temp_gearbox","value":24.844127},{"name":"oil_temp_swivel","value":35.044737},{"name":"pressure_gearbox","value":1.607444},{"name":"rpm","value":0.269653},{"name":"temp_ambient","value":15.150139},{"name":"torque","value":0.06206},{"name":"wob","value":-3.960811}]},{"id":44,"meanCentroidDist":0.550699,"size":4,"centroid":[{"name":"hook_load","value":94.52282},{"name":"oil_temp_gearbox","value":28.633038},{"name":"oil_temp_swivel","value":35.765694},{"name":"pressure_gearbox","value":2.586591},{"name":"rpm","value":30.362326},{"name":"temp_ambient","value":15.290741},{"name":"torque","value":4.337322},{"name":"wob","value":-4.26506}]}],"intensities":[[-0.408719,0,0,0.408719],[150,-150,0,0],[0,0,0,0],[0,0,6.143345,-6.143345]],"children":[{"id":"43","size":1709,"states":[{"id":45,"meanCentroidDist":0.257352,"size":43,"centroid":[{"name":"hook_load","value":94.252286},{"name":"oil_temp_gearbox","value":25.092248},{"name":"oil_temp_swivel","value":35.065512},{"name":"pressure_gearbox","value":1.614465},{"name":"rpm","value":0.267692},{"name":"temp_ambient","value":15.151698},{"name":"torque","value":0.062804},{"name":"wob","value":-3.994517}]},{"id":46,"meanCentroidDist":0.559825,"size":1666,"centroid":[{"name":"hook_load","value":94.161773},{"name":"oil_temp_gearbox","value":24.568818},{"name":"oil_temp_swivel","value":35.021686},{"name":"pressure_gearbox","value":1.600142},{"name":"rpm","value":0.271829},{"name":"temp_ambient","value":15.148409},{"name":"torque","value":0.061261},{"name":"wob","value":-3.904008}]}],"intensities":[[-163.636364,163.636364],[1.633394,-1.633394]],"children":[{"id":"46","size":1666,"states":[{"id":47,"meanCentroidDist":0.116835,"size":658,"centroid":[{"name":"hook_load","value":93.805176},{"name":"oil_temp_gearbox","value":23.01105},{"name":"oil_temp_swivel","value":34.556063},{"name":"pressure_gearbox","value":1.573593},{"name":"rpm","value":0.315776},{"name":"temp_ambient","value":15.085373},{"name":"torque","value":0.06373},{"name":"wob","value":-3.547403}]},{"id":48,"meanCentroidDist":0.438573,"size":1008,"centroid":[{"name":"hook_load","value":93.466758},{"name":"oil_temp_gearbox","value":21.452066},{"name":"oil_temp_swivel","value":33.525562},{"name":"pressure_gearbox","value":1.536535},{"name":"rpm","value":0.413039},{"name":"temp_ambient","value":14.976699},{"name":"torque","value":0.077826},{"name":"wob","value":-3.208986}]}],"intensities":[[-5.471125,5.471125],[0,0]],"children":[]}]}]}]},{"id":"2","size":2549,"states":[{"id":12,"meanCentroidDist":0.469673,"size":707,"centroid":[{"name":"hook_load","value":84.020017},{"name":"oil_temp_gearbox","value":30.561147},{"name":"oil_temp_swivel","value":35.405425},{"name":"pressure_gearbox","value":2.61756},{"name":"rpm","value":89.791283},{"name":"temp_ambient","value":16.156162},{"name":"torque","value":8.75248},{"name":"wob","value":1.219369}]},{"id":13,"meanCentroidDist":0.177046,"size":1147,"centroid":[{"name":"hook_load","value":82.546027},{"name":"oil_temp_gearbox","value":30.41957},{"name":"oil_temp_swivel","value":34.93859},{"name":"pressure_gearbox","value":2.643322},{"name":"rpm","value":89.757183},{"name":"temp_ambient","value":16.427058},{"name":"torque","value":9.022988},{"name":"wob","value":2.693359}]},{"id":14,"meanCentroidDist":0.073223,"size":686,"centroid":[{"name":"hook_load","value":82.628356},{"name":"oil_temp_gearbox","value":29.521747},{"name":"oil_temp_swivel","value":34.480988},{"name":"pressure_gearbox","value":2.650727},{"name":"rpm","value":100.956203},{"name":"temp_ambient","value":16.435686},{"name":"torque","value":8.622948},{"name":"wob","value":2.603227}]},{"id":15,"meanCentroidDist":0.145434,"size":9,"centroid":[{"name":"hook_load","value":83.113918},{"name":"oil_temp_gearbox","value":28.311923},{"name":"oil_temp_swivel","value":34.417984},{"name":"pressure_gearbox","value":2.841238},{"name":"rpm","value":64.273033},{"name":"temp_ambient","value":16.400366},{"name":"torque","value":6.568553},{"name":"wob","value":1.849776}]}],"intensities":[[0,0,0,0],[3.138622,-3.138622,0,0],[0,5.247813,-5.247813,0],[0,0,400,-400]],"children":[]},{"id":"3","size":775,"states":[{"id":16,"meanCentroidDist":0.769043,"size":392,"centroid":[{"name":"hook_load","value":3.691146},{"name":"oil_temp_gearbox","value":30.267146},{"name":"oil_temp_swivel","value":35.595829},{"name":"pressure_gearbox","value":1.154975},{"name":"rpm","value":4.737862},{"name":"temp_ambient","value":15.68},{"name":"torque","value":0.474555},{"name":"wob","value":81.548243}]},{"id":17,"meanCentroidDist":0.203739,"size":356,"centroid":[{"name":"hook_load","value":3.408217},{"name":"oil_temp_gearbox","value":28.354078},{"name":"oil_temp_swivel","value":34.92917},{"name":"pressure_gearbox","value":1.145736},{"name":"rpm","value":4.072013},{"name":"temp_ambient","value":16.33494},{"name":"torque","value":0.461588},{"name":"wob","value":81.555481}]},{"id":18,"meanCentroidDist":0.91989,"size":27,"centroid":[{"name":"hook_load","value":39.589375},{"name":"oil_temp_gearbox","value":29.841773},{"name":"oil_temp_swivel","value":35.911241},{"name":"pressure_gearbox","value":1.46067},{"name":"rpm","value":0.439527},{"name":"temp_ambient","value":15.68},{"name":"torque","value":0.141306},{"name":"wob","value":45.650016}]}],"intensities":[[-8.391608,0,8.391608],[0,-0.668648,0.668648],[144,0,-144]],"children":[]},{"id":"4","size":35,"states":[{"id":19,"meanCentroidDist":0.250396,"size":8,"centroid":[{"name":"hook_load","value":2.307634},{"name":"oil_temp_gearbox","value":28.629574},{"name":"oil_temp_swivel","value":34.670193},{"name":"pressure_gearbox","value":3.097094},{"name":"rpm","value":1.096926},{"name":"temp_ambient","value":16.382768},{"name":"torque","value":24.789459},{"name":"wob","value":82.656058}]},{"id":20,"meanCentroidDist":0.236523,"size":19,"centroid":[{"name":"hook_load","value":1.427658},{"name":"oil_temp_gearbox","value":28.622903},{"name":"oil_temp_swivel","value":34.664713},{"name":"pressure_gearbox","value":3.208261},{"name":"rpm","value":0.330288},{"name":"temp_ambient","value":16.38315},{"name":"torque","value":34.216784},{"name":"wob","value":83.536044}]},{"id":21,"meanCentroidDist":0.253751,"size":8,"centroid":[{"name":"hook_load","value":3.117293},{"name":"oil_temp_gearbox","value":28.625778},{"name":"oil_temp_swivel","value":34.667075},{"name":"pressure_gearbox","value":2.572863},{"name":"rpm","value":2.230229},{"name":"temp_ambient","value":16.382985},{"name":"torque","value":11.612391},{"name":"wob","value":81.846408}]}],"intensities":[[-1920,720,1200],[189.473684,-189.473684,0],[900,0,-900]],"children":[]},{"id":"5","size":1378,"states":[{"id":22,"meanCentroidDist":0.230752,"size":160,"centroid":[{"name":"hook_load","value":94.466636},{"name":"oil_temp_gearbox","value":33.607058},{"name":"oil_temp_swivel","value":37.056399},{"name":"pressure_gearbox","value":1.481105},{"name":"rpm","value":0.326465},{"name":"temp_ambient","value":15.75},{"name":"torque","value":0.181187},{"name":"wob","value":-9.227248}]},{"id":23,"meanCentroidDist":0.265563,"size":280,"centroid":[{"name":"hook_load","value":88.177237},{"name":"oil_temp_gearbox","value":32.232505},{"name":"oil_temp_swivel","value":36.705822},{"name":"pressure_gearbox","value":1.462802},{"name":"rpm","value":0.39196},{"name":"temp_ambient","value":15.75},{"name":"torque","value":0.1771},{"name":"wob","value":-2.93785}]},{"id":24,"meanCentroidDist":0.688422,"size":611,"centroid":[{"name":"hook_load","value":89.428257},{"name":"oil_temp_gearbox","value":30.387976},{"name":"oil_temp_swivel","value":35.119609},{"name":"pressure_gearbox","value":1.631882},{"name":"rpm","value":4.331399},{"name":"temp_ambient","value":15.68},{"name":"torque","value":1.450635},{"name":"wob","value":-4.188851}]},{"id":25,"meanCentroidDist":0.852333,"size":3,"centroid":[{"name":"hook_load","value":61.09675},{"name":"oil_temp_gearbox","value":30.008685},{"name":"oil_temp_swivel","value":35.736036},{"name":"pressure_gearbox","value":1.449002},{"name":"rpm","value":0.484291},{"name":"temp_ambient","value":15.68},{"name":"torque","value":0.133919},{"name":"wob","value":24.14265}]},{"id":26,"meanCentroidDist":0.018213,"size":51,"centroid":[{"name":"hook_load","value":94.479384},{"name":"oil_temp_gearbox","value":32.010006},{"name":"oil_temp_swivel","value":36.558091},{"name":"pressure_gearbox","value":1.436827},{"name":"rpm","value":0.501197},{"name":"temp_ambient","value":16.25},{"name":"torque","value":0.109959},{"name":"wob","value":-9.515686}]},{"id":27,"meanCentroidDist":0.699839,"size":6,"centroid":[{"name":"hook_load","value":91.895805},{"name":"oil_temp_gearbox","value":33.809578},{"name":"oil_temp_swivel","value":37.188768},{"name":"pressure_gearbox","value":2.17684},{"name":"rpm","value":25.519948},{"name":"temp_ambient","value":15.75},{"name":"torque","value":3.817527},{"name":"wob","value":-6.656419}]},{"id":28,"meanCentroidDist":0.51934,"size":267,"centroid":[{"name":"hook_load","value":87.542637},{"name":"oil_temp_gearbox","value":30.47725},{"name":"oil_temp_swivel","value":36.26596},{"name":"pressure_gearbox","value":1.568633},{"name":"rpm","value":1.51519},{"name":"temp_ambient","value":15.712301},{"name":"torque","value":0.588112},{"name":"wob","value":-2.30325}]}],"intensities":[[-22.5,22.5,0,0,0,0,0],[0,-12.857143,0,0,0,0,12.857143],[0,0,0,0,0,0,0],[0,0,7.843137,-7.843137,0,0,0],[0,0,0,0,-0.650172,0.650172,0],[600,0,0,0,0,-600,0],[0,0,0,13.483146,0,0,-13.483146]],"children":[{"id":"24","size":611,"states":[{"id":36,"meanCentroidDist":0.129123,"size":20,"centroid":[{"name":"hook_load","value":89.883481},{"name":"oil_temp_gearbox","value":30.408551},{"name":"oil_temp_swivel","value":35.126709},{"name":"pressure_gearbox","value":1.438213},{"name":"rpm","value":1.169029},{"name":"temp_ambient","value":15.68},{"name":"torque","value":0.471483},{"name":"wob","value":-4.644072}]},{"id":37,"meanCentroidDist":0.340968,"size":8,"centroid":[{"name":"hook_load","value":87.291712},{"name":"oil_temp_gearbox","value":30.333147},{"name":"oil_temp_swivel","value":35.100665},{"name":"pressure_gearbox","value":2.123549},{"name":"rpm","value":12.122717},{"name":"temp_ambient","value":15.68},{"name":"torque","value":3.988969},{"name":"wob","value":-2.052317}]},{"id":38,"meanCentroidDist":0.369453,"size":583,"centroid":[{"name":"hook_load","value":95.049011},{"name":"oil_temp_gearbox","value":28.631375},{"name":"oil_temp_swivel","value":35.764446},{"name":"pressure_gearbox","value":2.314331},{"name":"rpm","value":13.165752},{"name":"temp_ambient","value":15.290384},{"name":"torque","value":2.839779},{"name":"wob","value":-4.791221}]}],"intensities":[[-180,180,0],[0,-0.407056,0.407056],[0,0,0]],"children":[]},{"id":"28","size":267,"states":[{"id":39,"meanCentroidDist":0.25942,"size":108,"centroid":[{"name":"hook_load","value":91.754543},{"name":"oil_temp_gearbox","value":29.888171},{"name":"oil_temp_swivel","value":36.133327},{"name":"pressure_gearbox","value":1.470376},{"name":"rpm","value":0.483802},{"name":"temp_ambient","value":15.68},{"name":"torque","value":0.111861},{"name":"wob","value":-6.515158}]},{"id":40,"meanCentroidDist":0.112119,"size":159,"centroid":[{"name":"hook_load","value":84.682004},{"name":"oil_temp_gearbox","value":30.877324},{"name":"oil_temp_swivel","value":36.356041},{"name":"pressure_gearbox","value":1.635367},{"name":"rpm","value":2.215687},{"name":"temp_ambient","value":15.734239},{"name":"torque","value":0.911572},{"name":"wob","value":0.557383}]}],"intensities":[[0,0],[22.641509,-22.641509]],"children":[]}]},{"id":"7","size":37,"states":[{"id":29,"meanCentroidDist":0.21779,"size":16,"centroid":[{"name":"hook_load","value":4.115331},{"name":"oil_temp_gearbox","value":30.616844},{"name":"oil_temp_swivel","value":35.253215},{"name":"pressure_gearbox","value":2.947531},{"name":"rpm","value":1.996086},{"name":"temp_ambient","value":15.68},{"name":"torque","value":15.800971},{"name":"wob","value":81.124062}]},{"id":30,"meanCentroidDist":0.277603,"size":21,"centroid":[{"name":"hook_load","value":4.797362},{"name":"oil_temp_gearbox","value":30.601894},{"name":"oil_temp_swivel","value":35.240003},{"name":"pressure_gearbox","value":3.202949},{"name":"rpm","value":0.358796},{"name":"temp_ambient","value":15.68},{"name":"torque","value":32.566358},{"name":"wob","value":80.442015}]}],"intensities":[[-327.272727,327.272727],[171.428571,-171.428571]],"children":[]},{"id":"8","size":5018,"states":[{"id":31,"meanCentroidDist":0.242814,"size":2804,"centroid":[{"name":"hook_load","value":83.315864},{"name":"oil_temp_gearbox","value":31.281893},{"name":"oil_temp_swivel","value":35.848055},{"name":"pressure_gearbox","value":2.60569},{"name":"rpm","value":118.014571},{"name":"temp_ambient","value":15.889038},{"name":"torque","value":9.874271},{"name":"wob","value":1.923524}]},{"id":32,"meanCentroidDist":0.381238,"size":1366,"centroid":[{"name":"hook_load","value":84.483854},{"name":"oil_temp_gearbox","value":32.986348},{"name":"oil_temp_swivel","value":36.854202},{"name":"pressure_gearbox","value":2.599777},{"name":"rpm","value":121.364491},{"name":"temp_ambient","value":15.781836},{"name":"torque","value":9.524258},{"name":"wob","value":0.755534}]},{"id":33,"meanCentroidDist":0.335843,"size":848,"centroid":[{"name":"hook_load","value":90.42161},{"name":"oil_temp_gearbox","value":33.794786},{"name":"oil_temp_swivel","value":37.199804},{"name":"pressure_gearbox","value":2.519833},{"name":"rpm","value":83.50936},{"name":"temp_ambient","value":15.75},{"name":"torque","value":6.68722},{"name":"wob","value":-5.182239}]}],"intensities":[[-5.417607,5.417607,0],[0,-5.270864,5.270864],[1.152369,0,-1.152369]],"children":[{"id":"33","size":848,"states":[{"id":34,"meanCentroidDist":0.121984,"size":8,"centroid":[{"name":"hook_load","value":90.449808},{"name":"oil_temp_gearbox","value":33.795108},{"name":"oil_temp_swivel","value":37.199564},{"name":"pressure_gearbox","value":2.517971},{"name":"rpm","value":82.386581},{"name":"temp_ambient","value":15.75},{"name":"torque","value":6.64142},{"name":"wob","value":-5.210437}]},{"id":35,"meanCentroidDist":0.095417,"size":840,"centroid":[{"name":"hook_load","value":89.992176},{"name":"oil_temp_gearbox","value":32.514256},{"name":"oil_temp_swivel","value":36.488668},{"name":"pressure_gearbox","value":2.55933},{"name":"rpm","value":80.155772},{"name":"temp_ambient","value":15.695885},{"name":"torque","value":7.675519},{"name":"wob","value":-6.189385}]}],"intensities":[[-0.554871,0.554871],[0,0]],"children":[]}]}]};


var MAViz = function (opts) {
	var url = opts.url;
	var networkContainer = document.getElementById(opts.networkContainer);
	var treeContainer = document.getElementById(opts.treeContainer);
	
	var treeNodes = new vis.DataSet();
	var treeEdges = new vis.DataSet();
	var networkNodes = new vis.DataSet();
	var networkEdges = new vis.DataSet();
	
	var treeData = {
		nodes: treeNodes,
		edges: treeEdges
	};
	
	var networkData= {
		nodes: networkNodes,
		edges: networkEdges
	};
	
	var groupsTable = [];
	
	var networkOptions = {
		edges: {
			style: "arrow",
			arrowScaleFactor: 0.4,
			widthMax: 6
		},
		nodes: {
			fontSize: 20
		},
		physics: {
			barnesHut: {
				springLength: 150
			}
		}
	};
	
	var treeOptions = {
		hierarchicalLayout: {
			layout: "direction"
		},
		edges: {
			style: "arrow",
			arrowScaleFactor: 0.4
		},
		nodes: {
			color: {
				background: "#97C2FC",
				highlight: {
					background: "#00FF00"
				}
			}
		}
	};
	
	function onNetworkDoubleClick(properties) {
		alert("double click");
	}
	
	function onTreeDoubleClick(properties) {
		constructNetwork(properties.nodes[0]);
	}
	
	function onTreeSelect(properties) {
		if (properties.nodes[0]) {
			constructNetwork(properties.nodes[0]);
		}
	}
	
	function onNetworkSelect(properties) {
		if (properties.nodes[0]) {
			//alert("node selected - x, y: " + properties.nodes[0].x + ", " + properties.nodes[0].y);
		}
	}
	
	function addEdgeToTree(id, childId) {
		treeEdges.add({from: id, to: childId, width: 3});
	}
	
	function addNodesAndEdgesToTree(jsonObject) {
		treeNodes.add({id: jsonObject.id, label: "" + jsonObject.id, childrenActive: false});
		groupsTable.push({id: jsonObject.id, states: jsonObject.states, intensities: jsonObject.intensities});
		
		for (var i = 0; i < jsonObject.children.length; i++) {
			addNodesAndEdgesToTree(jsonObject.children[i]);
			addEdgeToTree(jsonObject.id, jsonObject.children[i].id);
		}
	}
	
	function constructNetwork(clickedId) {
		networkData.nodes.clear();
		networkData.edges.clear();
		
		for (var i = 0; i < groupsTable.length; i++) {
			if (groupsTable[i].id == clickedId) {
				
				// add nodes
				for (var j = 0; j < groupsTable[i].states.length; j++) {
					networkData.nodes.add({id: groupsTable[i].states[j].id, shape: "dot", value: groupsTable[i].states[j].size, 
										label: "" + groupsTable[i].states[j].id, 
										title: (groupsTable[i].states[j].centroid[j].name + ": " + groupsTable[i].states[j].centroid[j].value)});
				}
				
				//add edges
				for (var x = 0; x < groupsTable[i].intensities.length; x++) {
					for (var y = 0; y < groupsTable[i].intensities[x].length; y++) {
						if (groupsTable[i].intensities[x][y] > 0) {
							var a = groupsTable[i].states[x].id;
							var b = groupsTable[i].states[y].id;
							networkData.edges.add({from: a, to: b, value: groupsTable[i].intensities[x][y],
											label: "" + groupsTable[i].intensities[x][y].toFixed(2)});
						}
					}
				}
			}
		}
	}
	
	function draw(dataJson) {
		treeNodes = new vis.DataSet();
		treeEdges = new vis.DataSet();
		networkNodes = new vis.DataSet();
		networkEdges = new vis.DataSet();
		
		groupsTable = [];
		
		addNodesAndEdgesToTree(dataJson);
		
		treeData = {
			nodes: treeNodes,
			edges: treeEdges
		};
		
		networkData= {
			nodes: networkNodes,
			edges: networkEdges
		};
		
		var network = new vis.Network(networkContainer, networkData, networkOptions);
		var tree = new vis.Network(treeContainer, treeData, treeOptions);
		
		tree.on('select', onTreeSelect);
		tree.on('doubleClick', onTreeDoubleClick);
		network.on('select', onNetworkSelect);
		network.on('doubleClick', onNetworkDoubleClick);
	}
	
	var that = {
		refresh: function () {
			//$.ajax({
			//	url: url,
			//	data: { },
			//	success: function (data) {
			//		draw(data);
			//	},	
			//	dataType: 'json',
			//	error: function (jqXHR, jqXHR, status, err) {
			//		alert("failed to receive object: " + status + ", " + err);
			//	}
			//});
			data = testJSON;
			draw(data);
		}
		
	}
	
	return that;
}